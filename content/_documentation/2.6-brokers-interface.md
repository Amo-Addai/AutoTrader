---
title: AutoTrader Broker Interface
permalink: docs/brokers-interface
key: docs-brokers-interface
---

To make the transition from backtesting to live-trading as easy as possible, each broker integrated into AutoTrader 
interfaces with a strategy using a set of common methods. This means that the same strategy can be run with the 
virtual broker or any other broker in live trading without changing a single line of code in your strategy. This 
page provides a general overview of the methods contained within each broker interface module. Of course, the mechanics
behind each method will change depending on the broker, however each method will behave in the same way.


# Methods
The methods of the brokers are described below.




|           Method          | Function                                                                                              |
| :-----------------------: | ----------------------------------------------------------------------------------------------------- |
|         `__init__`        | Initialises virtual broker with attributes.                                                           |
|        `get_price`        | Returns current price data                                                                            |
|       `place_order`       | Recieves order details and moves to `pending_positions` dictionary.                                   |
|       `open_position`     | Opens a position and moves it into `open_positions` dictionary.                                          |
|     `update_positions`    | Iterates through `pending_positions` and `open_positions` dictionaries and updates them based on order details and current price. |
|    `close_position`       | Closes a position and moves it into `closed_positions` dictionary.                                    |
|     `add_funds`           | Adds funds to account.                                                                                |
|    `calculate_margin`     | Calculates margin required to take a position.                                                        |
|        `update_MDD`       | Updates the maximum drawdown of the account.                                                          |



## Utility Functions

Refer to the [Virtual Broker Utility Functions](virtual-utils) for more information.






## Order Handling

An order is placed through AutoTrader in the form of a dictionary.

Returned by a method named `generate_signal` in the [strategy module](strategies).



| Key | Description |  Specification  |
|-----|-------------|----|
| `order_type` | Order type | Required |
| `order_limit_price` | ||
| `direction` | Trade direction (1 for long or -1 for short trades) | Required |
| `size` | Trade size, specified in trade units | Optional |
| `take_profit` | Take profit, specified as price | Optional |
| `take_distance` | Take profit, specified in pips from entry price | Optional |
| `stop_loss` | Stop loss, specified as price | Optional |
| `stop_distance` | Stop loss, specified in pips from entry price | Optional |
| `stop_type` | Type of stop loss order | Optional |
| `related_orders` | A dictionary of related order numbers | Optional |




### Order Types

The following tables provides accepted values for the `order_type` specification of an order.

| Order Type | Description | Additional keys required |
|------------|-------------|--------------------------|
| `market`   | A market order type | None |
| `limit` | A limit order type | `order_limit_price` |
| `stop-limit` | A stop-limit order type | `order_limit_price` and `order_stop_price` |


#### Market Order
A market order is 

`'order_type': 'market'`

order_limit_price must be specified for limit orders
order_stop_price must be specified for stop-limit order



`stop_price` always takes precedence over `stop_distance`. That is, if `stop_price` is provided along with a `stop_distance`, 
the stop loss will be set at the price defined by `stop_price`. 

AutoTrader is intelligent when it comes to order types. If your strategy has no stop loss, you do not need to include it in the 
signal dictionary. If you prefer to set a stop loss in terms of distance in pips, you can do that instead. Same goes for take 
profit levels, specify price or distance in pips. The choice is yours.



## Stop loss order types

- limit
- trailing
